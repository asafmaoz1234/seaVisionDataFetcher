name: Build and test

on:
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Set up JDK 8
        uses: actions/setup-java@v3
        with:
          java-version: '8'
          distribution: 'corretto'
          cache: maven
      - name: Build and test
        run: mvn --batch-mode --update-snapshots package
        env:
          API_AUTH_KEY: ${{ secrets.API_AUTH_KEY }}
          API_REQUEST_PARAMS: ${{ secrets.API_REQUEST_PARAMS }}
          API_REQUEST_POINT_LAT: ${{ secrets.API_REQUEST_POINT_LAT }}
          API_REQUEST_POINT_LNG: ${{ secrets.API_REQUEST_POINT_LNG }}
          MAX_WAVE_FOR_SNORKEL: ${{ secrets.MAX_WAVE_FOR_SNORKEL }}
          API_REQUEST_SOURCE: ${{ secrets.API_REQUEST_SOURCE }}
          MAX_CONSECUTIVE_INFRACTIONS: ${{ secrets.MAX_CONSECUTIVE_INFRACTIONS }}
          TOTAL_INFRACTIONS_ALLOWED: ${{ secrets.TOTAL_INFRACTIONS_ALLOWED }}
          WEATHER_API_BASE_URL: ${{ secrets.WEATHER_API_BASE_URL }}
